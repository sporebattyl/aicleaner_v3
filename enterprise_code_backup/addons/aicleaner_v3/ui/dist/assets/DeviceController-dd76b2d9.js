var e=(e,s,i)=>new Promise((n,r)=>{var l=e=>{try{c(i.next(e))}catch(s){r(s)}},t=e=>{try{c(i.throw(e))}catch(s){r(s)}},c=e=>e.done?n(e.value):Promise.resolve(e.value).then(l,t);c((i=i.apply(e,s)).next())});import{r as s,j as i}from"./vendor-react-028964e9.js";import{A as n}from"./app-services-39021a89.js";import{a as r,A as l,B as t,b as c,M as d}from"./vendor-ui-95f0caeb.js";import"./vendor-export-9f6dbaf1.js";import"./vendor-utils-818bbafa.js";import"./app-analytics-3785476f.js";import"./vendor-charts-07629b84.js";import"./vendor-date-16f33ebf.js";import"./vendor-misc-6615fe3f.js";const a=()=>{var a;const[o,j]=s.useState([]),[h,x]=s.useState(!0),[p,v]=s.useState(null),[m,u]=s.useState(!1),[y,f]=s.useState(null);s.useEffect(()=>{g()},[]);const g=()=>e(void 0,null,function*(){try{const e=yield n.getDevices();j(e)}catch(e){v("Failed to load devices")}finally{x(!1)}}),S=(s,i)=>e(void 0,null,function*(){try{yield n.controlDevice(s,i),yield g()}catch(e){v(`Failed to ${i} device`)}});return i.jsxs("div",{children:[i.jsxs(r,{children:[i.jsx(r.Header,{children:i.jsx("h4",{children:"Device Control Panel"})}),i.jsxs(r.Body,{children:[p&&i.jsx(l,{variant:"danger",children:p}),o.map(e=>i.jsx(r,{className:"mb-3",children:i.jsx(r.Body,{children:i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsxs("div",{children:[i.jsx("h5",{children:e.name}),i.jsx("p",{className:"text-muted",children:e.type}),i.jsx(t,{bg:e.online?"success":"secondary",children:e.online?"Online":"Offline"})]}),i.jsxs("div",{children:[i.jsx(c,{variant:"outline-primary",size:"sm",className:"me-2",onClick:()=>(e=>{f(e),u(!0)})(e),children:"Details"}),e.controllable&&i.jsxs(i.Fragment,{children:[i.jsx(c,{variant:"success",size:"sm",className:"me-2",onClick:()=>S(e.id,"start"),disabled:!e.online,children:"Start"}),i.jsx(c,{variant:"danger",size:"sm",onClick:()=>S(e.id,"stop"),disabled:!e.online,children:"Stop"})]})]})]})})},e.id))]})]}),i.jsxs(d,{show:m,onHide:()=>u(!1),size:"lg",children:[i.jsx(d.Header,{closeButton:!0,children:i.jsxs(d.Title,{children:[null==y?void 0:y.name," Details"]})}),i.jsx(d.Body,{children:y&&i.jsxs("div",{children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Type:"})," ",y.type]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Status:"})," ",y.online?"Online":"Offline"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Seen:"})," ",y.last_seen]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Capabilities:"})," ",null==(a=y.capabilities)?void 0:a.join(", ")]}),y.properties&&i.jsxs("div",{children:[i.jsx("h6",{children:"Properties:"}),i.jsx("pre",{children:JSON.stringify(y.properties,null,2)})]})]})}),i.jsx(d.Footer,{children:i.jsx(c,{variant:"secondary",onClick:()=>u(!1),children:"Close"})})]})]})};export{a as DeviceController};
