var e=Object.defineProperty,s=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,l=(s,n,i)=>n in s?e(s,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[n]=i,r=(e,s)=>{for(var n in s||(s={}))a.call(s,n)&&l(e,n,s[n]);if(i)for(var n of i(s))t.call(s,n)&&l(e,n,s[n]);return e},c=(e,i)=>s(e,n(i)),d=(e,s,n)=>new Promise((i,a)=>{var t=e=>{try{r(n.next(e))}catch(s){a(s)}},l=e=>{try{r(n.throw(e))}catch(s){a(s)}},r=e=>e.done?i(e.value):Promise.resolve(e.value).then(t,l);r((n=n.apply(e,s)).next())});import{r as o,j as m}from"./vendor-react-028964e9.js";import{A as h}from"./app-services-39021a89.js";import{a as x,S as u,A as j,F as g,b as v,R as b,C as p,O as y,T as f,B as N,I as _,M as C,L as k,c as w,P as S,d as T,e as L,f as A,g as z}from"./vendor-ui-95f0caeb.js";import{F as q,a as O,b as I,c as B,d as G,e as F,f as E,g as P,h as H,i as M,j as D,k as R,l as Z,m as Q,n as J,o as V,p as U,q as K,r as $,s as W,t as Y,u as X,v as ee}from"./vendor-icons-3eef39ee.js";import{l as se}from"./vendor-utils-818bbafa.js";const ne=Object.freeze(Object.defineProperty({__proto__:null,ConfigurationManager:()=>{var e,s,n,i,a;const[t,l]=o.useState({}),[b,p]=o.useState(!0),[y,f]=o.useState(!1),[N,_]=o.useState(null),[C,k]=o.useState(!1);o.useEffect(()=>{w()},[]);const w=()=>d(void 0,null,function*(){try{p(!0);const e=yield h.getConfiguration();l(e),_(null)}catch(e){_("Failed to load configuration")}finally{p(!1)}}),S=(e,s,n)=>{l(i=>c(r({},i),{[e]:c(r({},i[e]),{[s]:n})}))};return b?m.jsx(x,{children:m.jsxs(x.Body,{className:"text-center",children:[m.jsx(u,{animation:"border"}),m.jsx("p",{children:"Loading configuration..."})]})}):m.jsxs(x,{children:[m.jsx(x.Header,{children:m.jsx("h4",{children:"AICleaner v3 Configuration"})}),m.jsxs(x.Body,{children:[N&&m.jsx(j,{variant:"danger",children:N}),C&&m.jsx(j,{variant:"success",children:"Configuration saved successfully!"}),m.jsxs(g,{children:[m.jsxs(x,{className:"mb-3",children:[m.jsx(x.Header,{children:"AI Provider Settings"}),m.jsxs(x.Body,{children:[m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Primary Provider"}),m.jsxs(g.Select,{value:(null==(e=t.ai)?void 0:e.primary_provider)||"",onChange:e=>S("ai","primary_provider",e.target.value),children:[m.jsx("option",{value:"openai",children:"OpenAI"}),m.jsx("option",{value:"anthropic",children:"Anthropic"}),m.jsx("option",{value:"google",children:"Google"}),m.jsx("option",{value:"ollama",children:"Ollama"})]})]}),m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"API Key"}),m.jsx(g.Control,{type:"password",value:(null==(s=t.ai)?void 0:s.api_key)||"",onChange:e=>S("ai","api_key",e.target.value),placeholder:"Enter API key"})]})]})]}),m.jsxs(x,{className:"mb-3",children:[m.jsx(x.Header,{children:"MQTT Settings"}),m.jsxs(x.Body,{children:[m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Broker Host"}),m.jsx(g.Control,{type:"text",value:(null==(n=t.mqtt)?void 0:n.broker_host)||"",onChange:e=>S("mqtt","broker_host",e.target.value),placeholder:"localhost"})]}),m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Broker Port"}),m.jsx(g.Control,{type:"number",value:(null==(i=t.mqtt)?void 0:i.broker_port)||1883,onChange:e=>S("mqtt","broker_port",parseInt(e.target.value))})]}),m.jsx(g.Check,{type:"checkbox",label:"Use TLS Encryption",checked:(null==(a=t.mqtt)?void 0:a.use_tls)||!1,onChange:e=>S("mqtt","use_tls",e.target.checked)})]})]}),m.jsx("div",{className:"d-grid",children:m.jsx(v,{variant:"primary",onClick:()=>d(void 0,null,function*(){try{f(!0),yield h.updateConfiguration(t),k(!0),setTimeout(()=>k(!1),3e3)}catch(e){_("Failed to save configuration")}finally{f(!1)}}),disabled:y,children:y?m.jsxs(m.Fragment,{children:[m.jsx(u,{as:"span",animation:"border",size:"sm",className:"me-2"}),"Saving..."]}):"Save Configuration"})})]})]})]})}},Symbol.toStringTag,{value:"Module"})),ie=({config:e,onChange:s,errors:n={},warnings:i={},canEdit:a,securityStatus:t})=>{const[l,C]=o.useState(!1),[k,w]=o.useState(!1),[S,T]=o.useState(null),[L,A]=o.useState({ca_cert:null,client_cert:null,client_key:null}),z=(n,i)=>{const a=c(r({},e),{[n]:i});s(a)},M=(e,s)=>{const n=s.target.files[0];if(n){A(s=>c(r({},s),{[e]:n}));z({ca_cert:"tls_ca_cert",client_cert:"tls_cert_file",client_key:"tls_key_file"}[e],`/certificates/${n.name}`)}},D=e=>{A(s=>c(r({},s),{[e]:null}));z({ca_cert:"tls_ca_cert",client_cert:"tls_cert_file",client_key:"tls_key_file"}[e],"")},R=(()=>{let s=0,n="low",i="danger";return e.use_tls&&(s+=40,n="medium",i="warning",e.tls_ca_cert&&(s+=20),e.tls_cert_file&&e.tls_key_file&&(s+=20),e.tls_insecure||(s+=10)),e.username&&e.password&&(s+=10),s>=80?(n="high",i="success"):s>=50&&(n="medium",i="warning"),{score:s,level:n,color:i}})();return m.jsxs("div",{className:"mqtt-configuration-section",children:[m.jsx(b,{className:"mb-4",children:m.jsx(p,{children:m.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[m.jsxs("div",{children:[m.jsxs("h5",{children:[m.jsx(q,{className:"me-2"}),"MQTT Discovery Configuration"]}),m.jsx("p",{className:"text-muted mb-0",children:"Configure MQTT broker connection and discovery settings"})]}),m.jsxs("div",{className:"d-flex align-items-center gap-3",children:[m.jsx(y,{placement:"left",overlay:m.jsxs(f,{children:["Security Score: ",R.score,"/100",m.jsx("br",{}),"Level: ",R.level.toUpperCase()]}),children:m.jsxs(N,{bg:R.color,className:"d-flex align-items-center",children:[m.jsx(O,{className:"me-1"}),R.level.toUpperCase()]})}),m.jsx(v,{variant:"outline-primary",size:"sm",onClick:()=>d(void 0,null,function*(){try{w(!0),T(null);const s=r({},e),n=yield h.post("/api/mqtt/test-connection",s);T({success:!0,message:n.message||"Connection successful",details:n.details})}catch(s){T({success:!1,message:s.message||"Connection failed",details:s.details})}finally{w(!1)}}),disabled:!a||k||!e.broker_address,children:k?m.jsxs(m.Fragment,{children:[m.jsx(u,{size:"sm",className:"me-2"}),"Testing..."]}):m.jsxs(m.Fragment,{children:[m.jsx(FaTestTube,{className:"me-2"}),"Test Connection"]})})]})]})})}),S&&m.jsx(b,{className:"mb-4",children:m.jsx(p,{children:m.jsx(j,{variant:S.success?"success":"danger",children:m.jsxs("div",{className:"d-flex align-items-center",children:[S.success?m.jsx(I,{className:"me-2"}):m.jsx(B,{className:"me-2"}),m.jsxs("div",{children:[m.jsx("strong",{children:"Connection Test Result:"})," ",S.message,S.details&&m.jsx("div",{className:"small mt-1",children:S.details})]})]})})})}),m.jsxs(x,{className:"mb-4",children:[m.jsx(x.Header,{children:m.jsx("h6",{className:"mb-0",children:"Broker Connection"})}),m.jsxs(x.Body,{children:[m.jsxs(b,{children:[m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Broker Address *"}),m.jsx(g.Control,{type:"text",value:e.broker_address||"",onChange:e=>z("broker_address",e.target.value),placeholder:"mqtt.example.com or localhost",disabled:!a,isInvalid:!!n["mqtt.broker_address"]}),m.jsx(g.Control.Feedback,{type:"invalid",children:n["mqtt.broker_address"]}),m.jsx(g.Text,{className:"text-muted",children:"Hostname or IP address of your MQTT broker"})]})}),m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Port"}),m.jsx(g.Control,{type:"number",value:e.broker_port||1883,onChange:e=>z("broker_port",parseInt(e.target.value)),min:"1",max:"65535",disabled:!a,isInvalid:!!n["mqtt.broker_port"]}),m.jsx(g.Control.Feedback,{type:"invalid",children:n["mqtt.broker_port"]}),m.jsx(g.Text,{className:"text-muted",children:"Standard: 1883 (plain), 8883 (TLS)"})]})})]}),m.jsxs(b,{children:[m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Username"}),m.jsx(g.Control,{type:"text",value:e.username||"",onChange:e=>z("username",e.target.value),placeholder:"MQTT username (optional)",disabled:!a,isInvalid:!!n["mqtt.username"]}),m.jsx(g.Control.Feedback,{type:"invalid",children:n["mqtt.username"]})]})}),m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Password"}),m.jsxs(_,{children:[m.jsx(g.Control,{type:l?"text":"password",value:e.password||"",onChange:e=>z("password",e.target.value),placeholder:"MQTT password (optional)",disabled:!a,isInvalid:!!n["mqtt.password"]}),m.jsx(v,{variant:"outline-secondary",onClick:()=>C(!l),disabled:!a,children:l?m.jsx(G,{}):m.jsx(F,{})})]}),m.jsx(g.Control.Feedback,{type:"invalid",children:n["mqtt.password"]})]})})]})]})]}),m.jsxs(x,{className:"mb-4",children:[m.jsx(x.Header,{children:m.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[m.jsxs("h6",{className:"mb-0",children:[m.jsx(E,{className:"me-2"}),"TLS/SSL Encryption"]}),m.jsx(g.Check,{type:"switch",label:"Enable TLS",checked:e.use_tls||!1,onChange:n=>(n=>{const i=r(c(r({},e),{use_tls:n}),n?{}:{tls_ca_cert:"",tls_cert_file:"",tls_key_file:"",tls_insecure:!1});s(i)})(n.target.checked),disabled:!a})]})}),m.jsx(x.Body,{children:e.use_tls?m.jsxs(m.Fragment,{children:[m.jsxs(j,{variant:"info",className:"mb-3",children:[m.jsx(O,{className:"me-2"}),"TLS encryption is enabled. Configure certificates below for enhanced security."]}),m.jsx(b,{children:m.jsx(p,{md:12,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[m.jsx(g.Label,{children:"CA Certificate"}),L.ca_cert&&m.jsxs(v,{variant:"outline-danger",size:"sm",onClick:()=>D("ca_cert"),children:[m.jsx(P,{className:"me-1"}),"Clear"]})]}),L.ca_cert?m.jsxs("div",{className:"d-flex align-items-center p-2 bg-light rounded",children:[m.jsx(H,{className:"me-2 text-success"}),m.jsx("span",{children:L.ca_cert.name})]}):m.jsx(g.Control,{type:"file",accept:".crt,.pem,.cer",onChange:e=>M("ca_cert",e),disabled:!a}),m.jsx(g.Text,{className:"text-muted",children:"Certificate Authority file to verify broker certificate"})]})})}),m.jsxs(b,{children:[m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[m.jsx(g.Label,{children:"Client Certificate"}),L.client_cert&&m.jsxs(v,{variant:"outline-danger",size:"sm",onClick:()=>D("client_cert"),children:[m.jsx(P,{className:"me-1"}),"Clear"]})]}),L.client_cert?m.jsxs("div",{className:"d-flex align-items-center p-2 bg-light rounded",children:[m.jsx(H,{className:"me-2 text-success"}),m.jsx("span",{children:L.client_cert.name})]}):m.jsx(g.Control,{type:"file",accept:".crt,.pem,.cer",onChange:e=>M("client_cert",e),disabled:!a}),m.jsx(g.Text,{className:"text-muted",children:"Client certificate for mutual authentication"})]})}),m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[m.jsx(g.Label,{children:"Private Key"}),L.client_key&&m.jsxs(v,{variant:"outline-danger",size:"sm",onClick:()=>D("client_key"),children:[m.jsx(P,{className:"me-1"}),"Clear"]})]}),L.client_key?m.jsxs("div",{className:"d-flex align-items-center p-2 bg-light rounded",children:[m.jsx(H,{className:"me-2 text-success"}),m.jsx("span",{children:L.client_key.name})]}):m.jsx(g.Control,{type:"file",accept:".key,.pem",onChange:e=>M("client_key",e),disabled:!a}),m.jsx(g.Text,{className:"text-muted",children:"Private key for client certificate"})]})})]}),m.jsxs(g.Group,{className:"mb-0",children:[m.jsx(g.Check,{type:"checkbox",label:"Skip certificate verification (insecure - development only)",checked:e.tls_insecure||!1,onChange:e=>z("tls_insecure",e.target.checked),disabled:!a}),m.jsx(g.Text,{className:"text-muted",children:"Only enable this for testing with self-signed certificates"})]})]}):m.jsxs(j,{variant:"warning",children:[m.jsx(B,{className:"me-2"}),"TLS encryption is disabled. All MQTT communication will be transmitted in plain text. This is not recommended for production environments."]})})]}),m.jsxs(x,{children:[m.jsx(x.Header,{children:m.jsx("h6",{className:"mb-0",children:"Discovery Settings"})}),m.jsx(x.Body,{children:m.jsxs(b,{children:[m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Discovery Prefix"}),m.jsx(g.Control,{type:"text",value:e.discovery_prefix||"homeassistant",onChange:e=>z("discovery_prefix",e.target.value),placeholder:"homeassistant",disabled:!a,isInvalid:!!n["mqtt.discovery_prefix"]}),m.jsx(g.Control.Feedback,{type:"invalid",children:n["mqtt.discovery_prefix"]}),m.jsx(g.Text,{className:"text-muted",children:"MQTT topic prefix for Home Assistant discovery"})]})}),m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Quality of Service (QoS)"}),m.jsxs(g.Select,{value:e.qos||1,onChange:e=>z("qos",parseInt(e.target.value)),disabled:!a,isInvalid:!!n["mqtt.qos"],children:[m.jsx("option",{value:0,children:"0 - At most once (fire and forget)"}),m.jsx("option",{value:1,children:"1 - At least once (acknowledged delivery)"}),m.jsx("option",{value:2,children:"2 - Exactly once (assured delivery)"})]}),m.jsx(g.Control.Feedback,{type:"invalid",children:n["mqtt.qos"]}),m.jsx(g.Text,{className:"text-muted",children:"Message delivery guarantee level"})]})})]})})]})]})},ae=({config:e,onChange:s,errors:n={},warnings:i={},canEdit:a,securityStatus:t})=>{var l,d,h,u,j,y,f,w,S,T,L,A,z,q,E,P,H,R;const[Z,Q]=o.useState(!1),[J,V]=o.useState(!1),U=(n,i)=>{const a=c(r({},e),{[n]:i});s(a)},K=(s,n,i)=>{const a=r({},e.roles);a[s]||(a[s]={}),a[s][n]=i,U("roles",a)},$=(()=>{let s=0,n=0;return n+=20,e.supervisor_token_valid&&(s+=20),n+=15,e.authentication_enabled&&(s+=15),n+=10,e.session_timeout&&e.session_timeout>0&&(s+=10),n+=15,e.audit_logging&&(s+=15),n+=20,e.ssl_required&&(s+=20),n+=10,e.roles&&Object.keys(e.roles).length>0&&(s+=10),n+=10,e.threat_detection_enabled&&(s+=10),{score:s,total:100,percentage:Math.round(s/100*100)}})(),W=e=>e>=80?"success":e>=60?"warning":"danger";return m.jsxs("div",{className:"security-configuration-section",children:[m.jsx(b,{className:"mb-4",children:m.jsx(p,{children:m.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[m.jsxs("div",{children:[m.jsxs("h5",{children:[m.jsx(O,{className:"me-2"}),"Security Configuration"]}),m.jsx("p",{className:"text-muted mb-0",children:"Configure authentication, authorization, and security monitoring"})]}),m.jsxs("div",{className:"d-flex align-items-center gap-3",children:[m.jsxs("div",{className:"text-center",children:[m.jsxs(N,{bg:W($.percentage),className:"mb-1",children:[$.percentage,"% Compliant"]}),m.jsxs("div",{className:"small text-muted",children:["Security Score: ",$.score,"/",$.total]})]}),m.jsxs(v,{variant:"outline-info",size:"sm",onClick:()=>V(!0),children:[m.jsx(M,{className:"me-2"}),"View Compliance"]})]})]})})}),m.jsxs(x,{className:"mb-4",children:[m.jsx(x.Header,{children:m.jsx("h6",{className:"mb-0",children:"Authentication & Access Control"})}),m.jsxs(x.Body,{children:[m.jsxs(b,{children:[m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[m.jsx(g.Label,{children:"Supervisor Token"}),m.jsx(N,{bg:e.supervisor_token_valid?"success":"danger",children:e.supervisor_token_valid?"Valid":"Invalid"})]}),m.jsxs(_,{children:[m.jsx(g.Control,{type:Z?"text":"password",value:e.supervisor_token||"",onChange:e=>U("supervisor_token",e.target.value),placeholder:"Enter Home Assistant supervisor token",disabled:!a,isInvalid:!!n["security.supervisor_token"]}),m.jsx(v,{variant:"outline-secondary",onClick:()=>Q(!Z),disabled:!a,children:Z?m.jsx(G,{}):m.jsx(F,{})})]}),m.jsx(g.Control.Feedback,{type:"invalid",children:n["security.supervisor_token"]}),m.jsx(g.Text,{className:"text-muted",children:"Token for authenticating with Home Assistant Supervisor API"})]})}),m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Session Timeout (minutes)"}),m.jsx(g.Control,{type:"number",value:e.session_timeout||30,onChange:e=>U("session_timeout",parseInt(e.target.value)),min:"5",max:"1440",disabled:!a,isInvalid:!!n["security.session_timeout"]}),m.jsx(g.Control.Feedback,{type:"invalid",children:n["security.session_timeout"]}),m.jsx(g.Text,{className:"text-muted",children:"Automatic logout after inactivity (5-1440 minutes)"})]})})]}),m.jsxs(b,{children:[m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Check,{type:"switch",label:"Require Authentication",checked:e.authentication_enabled||!1,onChange:e=>U("authentication_enabled",e.target.checked),disabled:!a}),m.jsx(g.Text,{className:"text-muted",children:"Require valid supervisor token for all operations"})]})}),m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Check,{type:"switch",label:"Require SSL/TLS",checked:e.ssl_required||!1,onChange:e=>U("ssl_required",e.target.checked),disabled:!a}),m.jsx(g.Text,{className:"text-muted",children:"Force HTTPS connections for web interface"})]})})]})]})]}),m.jsxs(x,{className:"mb-4",children:[m.jsx(x.Header,{children:m.jsxs("h6",{className:"mb-0",children:[m.jsx(D,{className:"me-2"}),"Role-Based Access Control"]})}),m.jsx(x.Body,{children:m.jsxs(b,{children:[m.jsxs(p,{md:4,children:[m.jsx("h6",{children:"Administrator"}),m.jsx(g.Check,{label:"Configuration Management",checked:(null==(d=null==(l=e.roles)?void 0:l.admin)?void 0:d.config_management)||!1,onChange:e=>K("admin","config_management",e.target.checked),disabled:!a,className:"mb-2"}),m.jsx(g.Check,{label:"Security Management",checked:(null==(u=null==(h=e.roles)?void 0:h.admin)?void 0:u.security_management)||!1,onChange:e=>K("admin","security_management",e.target.checked),disabled:!a,className:"mb-2"}),m.jsx(g.Check,{label:"System Control",checked:(null==(y=null==(j=e.roles)?void 0:j.admin)?void 0:y.system_control)||!1,onChange:e=>K("admin","system_control",e.target.checked),disabled:!a,className:"mb-2"})]}),m.jsxs(p,{md:4,children:[m.jsx("h6",{children:"Operator"}),m.jsx(g.Check,{label:"Device Control",checked:(null==(w=null==(f=e.roles)?void 0:f.operator)?void 0:w.device_control)||!1,onChange:e=>K("operator","device_control",e.target.checked),disabled:!a,className:"mb-2"}),m.jsx(g.Check,{label:"Zone Management",checked:(null==(T=null==(S=e.roles)?void 0:S.operator)?void 0:T.zone_management)||!1,onChange:e=>K("operator","zone_management",e.target.checked),disabled:!a,className:"mb-2"}),m.jsx(g.Check,{label:"View Configuration",checked:(null==(A=null==(L=e.roles)?void 0:L.operator)?void 0:A.view_config)||!1,onChange:e=>K("operator","view_config",e.target.checked),disabled:!a,className:"mb-2"})]}),m.jsxs(p,{md:4,children:[m.jsx("h6",{children:"Viewer"}),m.jsx(g.Check,{label:"Read-Only Access",checked:(null==(q=null==(z=e.roles)?void 0:z.viewer)?void 0:q.read_only)||!1,onChange:e=>K("viewer","read_only",e.target.checked),disabled:!a,className:"mb-2"}),m.jsx(g.Check,{label:"View Dashboards",checked:(null==(P=null==(E=e.roles)?void 0:E.viewer)?void 0:P.view_dashboards)||!1,onChange:e=>K("viewer","view_dashboards",e.target.checked),disabled:!a,className:"mb-2"}),m.jsx(g.Check,{label:"View Devices",checked:(null==(R=null==(H=e.roles)?void 0:H.viewer)?void 0:R.view_devices)||!1,onChange:e=>K("viewer","view_devices",e.target.checked),disabled:!a,className:"mb-2"})]})]})})]}),m.jsxs(x,{children:[m.jsx(x.Header,{children:m.jsx("h6",{className:"mb-0",children:"Security Monitoring & Logging"})}),m.jsx(x.Body,{children:m.jsxs(b,{children:[m.jsxs(p,{md:6,children:[m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Check,{type:"switch",label:"Enable Audit Logging",checked:e.audit_logging||!1,onChange:e=>U("audit_logging",e.target.checked),disabled:!a}),m.jsx(g.Text,{className:"text-muted",children:"Log all configuration changes and security events"})]}),m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Check,{type:"switch",label:"Enable Threat Detection",checked:e.threat_detection_enabled||!1,onChange:e=>U("threat_detection_enabled",e.target.checked),disabled:!a}),m.jsx(g.Text,{className:"text-muted",children:"Real-time monitoring for suspicious activities"})]})]}),m.jsxs(p,{md:6,children:[m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Log Retention (days)"}),m.jsx(g.Control,{type:"number",value:e.log_retention_days||30,onChange:e=>U("log_retention_days",parseInt(e.target.value)),min:"1",max:"365",disabled:!a,isInvalid:!!n["security.log_retention_days"]}),m.jsx(g.Control.Feedback,{type:"invalid",children:n["security.log_retention_days"]}),m.jsx(g.Text,{className:"text-muted",children:"Number of days to retain security logs"})]}),m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Alert Threshold"}),m.jsxs(g.Select,{value:e.alert_threshold||"medium",onChange:e=>U("alert_threshold",e.target.value),disabled:!a,isInvalid:!!n["security.alert_threshold"],children:[m.jsx("option",{value:"low",children:"Low - All security events"}),m.jsx("option",{value:"medium",children:"Medium - Moderate and high severity"}),m.jsx("option",{value:"high",children:"High - High severity only"}),m.jsx("option",{value:"critical",children:"Critical - Critical severity only"})]}),m.jsx(g.Control.Feedback,{type:"invalid",children:n["security.alert_threshold"]}),m.jsx(g.Text,{className:"text-muted",children:"Minimum severity level for security alerts"})]})]})]})})]}),m.jsxs(C,{show:J,onHide:()=>V(!1),size:"lg",children:[m.jsx(C.Header,{closeButton:!0,children:m.jsxs(C.Title,{children:[m.jsx(M,{className:"me-2"}),"Security Compliance Report"]})}),m.jsxs(C.Body,{children:[m.jsxs("div",{className:"mb-3",children:[m.jsx("h6",{children:"Overall Compliance Score"}),m.jsx("div",{className:"progress mb-3",style:{height:"25px"},children:m.jsxs("div",{className:`progress-bar bg-${W($.percentage)}`,style:{width:`${$.percentage}%`},children:[$.percentage,"% (",$.score,"/",$.total,")"]})})]}),m.jsxs(k,{variant:"flush",children:[m.jsxs(k.Item,{className:"d-flex justify-content-between align-items-center",children:[m.jsx("span",{children:"Supervisor Token Validation"}),e.supervisor_token_valid?m.jsxs(N,{bg:"success",children:[m.jsx(I,{})," Valid"]}):m.jsxs(N,{bg:"danger",children:[m.jsx(B,{})," Invalid"]})]}),m.jsxs(k.Item,{className:"d-flex justify-content-between align-items-center",children:[m.jsx("span",{children:"Authentication Required"}),e.authentication_enabled?m.jsxs(N,{bg:"success",children:[m.jsx(I,{})," Enabled"]}):m.jsxs(N,{bg:"danger",children:[m.jsx(B,{})," Disabled"]})]}),m.jsxs(k.Item,{className:"d-flex justify-content-between align-items-center",children:[m.jsx("span",{children:"Session Timeout Configured"}),e.session_timeout>0?m.jsxs(N,{bg:"success",children:[m.jsx(I,{})," ",e.session_timeout," minutes"]}):m.jsxs(N,{bg:"danger",children:[m.jsx(B,{})," Not configured"]})]}),m.jsxs(k.Item,{className:"d-flex justify-content-between align-items-center",children:[m.jsx("span",{children:"Audit Logging"}),e.audit_logging?m.jsxs(N,{bg:"success",children:[m.jsx(I,{})," Enabled"]}):m.jsxs(N,{bg:"warning",children:[m.jsx(B,{})," Disabled"]})]}),m.jsxs(k.Item,{className:"d-flex justify-content-between align-items-center",children:[m.jsx("span",{children:"SSL/TLS Required"}),e.ssl_required?m.jsxs(N,{bg:"success",children:[m.jsx(I,{})," Required"]}):m.jsxs(N,{bg:"warning",children:[m.jsx(B,{})," Optional"]})]}),m.jsxs(k.Item,{className:"d-flex justify-content-between align-items-center",children:[m.jsx("span",{children:"Role-Based Access Control"}),e.roles&&Object.keys(e.roles).length>0?m.jsxs(N,{bg:"success",children:[m.jsx(I,{})," Configured"]}):m.jsxs(N,{bg:"warning",children:[m.jsx(B,{})," Not configured"]})]}),m.jsxs(k.Item,{className:"d-flex justify-content-between align-items-center",children:[m.jsx("span",{children:"Threat Detection"}),e.threat_detection_enabled?m.jsxs(N,{bg:"success",children:[m.jsx(I,{})," Enabled"]}):m.jsxs(N,{bg:"warning",children:[m.jsx(B,{})," Disabled"]})]})]})]}),m.jsx(C.Footer,{children:m.jsx(v,{variant:"secondary",onClick:()=>V(!1),children:"Close"})})]})]})},te=({config:e,onChange:s,errors:n={},warnings:i={},canEdit:a,securityStatus:t})=>{var l,d,h,u,y,f,_,T;const[L,A]=o.useState(!1),[z,q]=o.useState(null),[O,I]=o.useState({name:"",description:"",area:"",automation_enabled:!0,schedule:{enabled:!1,start_time:"09:00",end_time:"17:00",days:[]},devices:[],ai_optimization:{enabled:!0,learning_mode:"adaptive",priority:"balanced"},triggers:[]}),B=Array.isArray(e)?e:[],G=()=>{A(!1),q(null),I({name:"",description:"",area:"",automation_enabled:!0,schedule:{enabled:!1,start_time:"09:00",end_time:"17:00",days:[]},devices:[],ai_optimization:{enabled:!0,learning_mode:"adaptive",priority:"balanced"},triggers:[]})},F=e=>"active"===e.status?"success":"inactive"===e.status?"secondary":"error"===e.status?"danger":"warning",E=e=>{var s,n,i,a;let t=70;return e.automation_enabled&&(t+=10),(null==(s=e.schedule)?void 0:s.enabled)&&(t+=10),(null==(n=e.ai_optimization)?void 0:n.enabled)&&(t+=10),(null==(i=e.devices)?void 0:i.length)>0&&(t+=5),(null==(a=e.triggers)?void 0:a.length)>0&&(t+=5),Math.min(t,100)};return m.jsxs("div",{className:"zone-configuration-section",children:[m.jsx(b,{className:"mb-4",children:m.jsx(p,{children:m.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[m.jsxs("div",{children:[m.jsxs("h5",{children:[m.jsx(R,{className:"me-2"}),"Zone Configuration"]}),m.jsx("p",{className:"text-muted mb-0",children:"Configure cleaning zones and automation rules"})]}),m.jsxs(v,{variant:"primary",onClick:()=>A(!0),disabled:!a,children:[m.jsx(Z,{className:"me-2"}),"Add Zone"]})]})})}),m.jsxs(b,{className:"mb-4",children:[m.jsx(p,{md:3,children:m.jsx(x,{className:"text-center",children:m.jsxs(x.Body,{children:[m.jsx("h4",{className:"text-primary",children:B.length}),m.jsx("small",{className:"text-muted",children:"Total Zones"})]})})}),m.jsx(p,{md:3,children:m.jsx(x,{className:"text-center",children:m.jsxs(x.Body,{children:[m.jsx("h4",{className:"text-success",children:B.filter(e=>"active"===e.status).length}),m.jsx("small",{className:"text-muted",children:"Active Zones"})]})})}),m.jsx(p,{md:3,children:m.jsx(x,{className:"text-center",children:m.jsxs(x.Body,{children:[m.jsx("h4",{className:"text-info",children:B.filter(e=>e.automation_enabled).length}),m.jsx("small",{className:"text-muted",children:"Automated"})]})})}),m.jsx(p,{md:3,children:m.jsx(x,{className:"text-center",children:m.jsxs(x.Body,{children:[m.jsx("h4",{className:"text-warning",children:B.filter(e=>{var s;return null==(s=e.schedule)?void 0:s.enabled}).length}),m.jsx("small",{className:"text-muted",children:"Scheduled"})]})})})]}),0===B.length?m.jsx(x,{children:m.jsxs(x.Body,{className:"text-center py-5",children:[m.jsx(R,{className:"text-muted mb-3",style:{fontSize:"3rem",opacity:.3}}),m.jsx("h5",{className:"text-muted",children:"No zones configured"}),m.jsx("p",{className:"text-muted mb-3",children:"Create your first zone to start automating your cleaning"}),m.jsxs(v,{variant:"outline-primary",onClick:()=>A(!0),disabled:!a,children:[m.jsx(Z,{className:"me-2"}),"Create First Zone"]})]})}):m.jsx(w,{children:B.map((e,n)=>{var i,t,l,c,d,o,h,x;return m.jsxs(w.Item,{eventKey:n.toString(),children:[m.jsx(w.Header,{children:m.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100 me-3",children:[m.jsxs("div",{className:"d-flex align-items-center",children:[m.jsx(Q,{className:"me-2"}),m.jsx("strong",{children:e.name}),m.jsx(N,{bg:F(e),className:"ms-2",children:e.status||"active"})]}),m.jsxs("div",{className:"d-flex align-items-center gap-2",children:[m.jsxs("small",{className:"text-muted",children:["Efficiency: ",E(e),"%"]}),m.jsx(S,{now:E(e),style:{width:"60px",height:"6px"},variant:E(e)>=80?"success":E(e)>=60?"warning":"danger"})]})]})}),m.jsx(w.Body,{children:m.jsxs(b,{children:[m.jsxs(p,{md:8,children:[m.jsxs("div",{className:"mb-3",children:[m.jsx("strong",{children:"Description:"})," ",e.description||"No description"]}),m.jsxs("div",{className:"mb-3",children:[m.jsx("strong",{children:"Area:"})," ",e.area||"Not specified"]}),m.jsxs(b,{className:"mb-3",children:[m.jsxs(p,{md:6,children:[m.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.automation_enabled?m.jsx(J,{className:"text-success me-2"}):m.jsx(V,{className:"text-muted me-2"}),m.jsxs("span",{children:["Automation ",e.automation_enabled?"Enabled":"Disabled"]})]}),m.jsxs("div",{className:"d-flex align-items-center mb-2",children:[(null==(i=e.schedule)?void 0:i.enabled)?m.jsx(J,{className:"text-success me-2"}):m.jsx(V,{className:"text-muted me-2"}),m.jsxs("span",{children:["Schedule ",(null==(t=e.schedule)?void 0:t.enabled)?"Active":"Inactive"]})]})]}),m.jsxs(p,{md:6,children:[m.jsxs("div",{className:"d-flex align-items-center mb-2",children:[(null==(l=e.ai_optimization)?void 0:l.enabled)?m.jsx(U,{className:"text-info me-2"}):m.jsx(U,{className:"text-muted me-2"}),m.jsxs("span",{children:["AI Optimization ",(null==(c=e.ai_optimization)?void 0:c.enabled)?"On":"Off"]})]}),m.jsxs("div",{className:"d-flex align-items-center mb-2",children:[m.jsx(K,{className:"text-secondary me-2"}),m.jsxs("span",{children:[(null==(d=e.devices)?void 0:d.length)||0," Device(s)"]})]})]})]}),(null==(o=e.schedule)?void 0:o.enabled)&&m.jsxs(j,{variant:"info",className:"mb-3",children:[m.jsx($,{className:"me-2"}),m.jsx("strong",{children:"Schedule:"})," ",e.schedule.start_time," - ",e.schedule.end_time,(null==(h=e.schedule.days)?void 0:h.length)>0&&m.jsxs("span",{children:[" on ",e.schedule.days.join(", ")]})]}),(null==(x=e.triggers)?void 0:x.length)>0&&m.jsxs("div",{className:"mb-3",children:[m.jsx("strong",{children:"Triggers:"}),m.jsx(k,{variant:"flush",className:"mt-2",children:e.triggers.map((e,s)=>m.jsxs(k.Item,{className:"px-0 py-2",children:[m.jsx(N,{bg:"secondary",className:"me-2",children:e.type}),e.condition," → ",e.action]},e.id||s))})]})]}),m.jsx(p,{md:4,children:m.jsxs("div",{className:"d-grid gap-2",children:[m.jsxs(v,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{q(e),I(r({},B[e])),A(!0)})(n),disabled:!a,children:[m.jsx(W,{className:"me-2"}),"Edit Zone"]}),m.jsxs(v,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{if(window.confirm("Are you sure you want to delete this zone?")){const n=B.filter((s,n)=>n!==e);s(n)}})(n),disabled:!a,children:[m.jsx(Y,{className:"me-2"}),"Delete Zone"]})]})})]})})]},e.id||n)})}),m.jsxs(C,{show:L,onHide:G,size:"lg",children:[m.jsx(C.Header,{closeButton:!0,children:m.jsxs(C.Title,{children:[m.jsx(R,{className:"me-2"}),null!==z?"Edit Zone":"Create New Zone"]})}),m.jsx(C.Body,{children:m.jsxs(g,{children:[m.jsxs(b,{className:"mb-3",children:[m.jsx(p,{md:6,children:m.jsxs(g.Group,{children:[m.jsx(g.Label,{children:"Zone Name *"}),m.jsx(g.Control,{type:"text",value:O.name,onChange:e=>I(c(r({},O),{name:e.target.value})),placeholder:"e.g., Living Room",required:!0})]})}),m.jsx(p,{md:6,children:m.jsxs(g.Group,{children:[m.jsx(g.Label,{children:"Area"}),m.jsx(g.Control,{type:"text",value:O.area,onChange:e=>I(c(r({},O),{area:e.target.value})),placeholder:"e.g., Ground Floor"})]})})]}),m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Description"}),m.jsx(g.Control,{as:"textarea",rows:2,value:O.description,onChange:e=>I(c(r({},O),{description:e.target.value})),placeholder:"Describe this zone and its cleaning requirements"})]}),m.jsxs(x,{className:"mb-3",children:[m.jsx(x.Header,{children:m.jsx("h6",{className:"mb-0",children:"Automation Settings"})}),m.jsxs(x.Body,{children:[m.jsx(g.Check,{type:"switch",label:"Enable Automation",checked:O.automation_enabled,onChange:e=>I(c(r({},O),{automation_enabled:e.target.checked})),className:"mb-3"}),m.jsxs(b,{children:[m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Learning Mode"}),m.jsxs(g.Select,{value:(null==(l=O.ai_optimization)?void 0:l.learning_mode)||"adaptive",onChange:e=>I(c(r({},O),{ai_optimization:c(r({},O.ai_optimization),{learning_mode:e.target.value})})),children:[m.jsx("option",{value:"adaptive",children:"Adaptive Learning"}),m.jsx("option",{value:"manual",children:"Manual Control"}),m.jsx("option",{value:"scheduled",children:"Scheduled Only"})]})]})}),m.jsx(p,{md:6,children:m.jsxs(g.Group,{className:"mb-3",children:[m.jsx(g.Label,{children:"Priority"}),m.jsxs(g.Select,{value:(null==(d=O.ai_optimization)?void 0:d.priority)||"balanced",onChange:e=>I(c(r({},O),{ai_optimization:c(r({},O.ai_optimization),{priority:e.target.value})})),children:[m.jsx("option",{value:"high",children:"High Priority"}),m.jsx("option",{value:"balanced",children:"Balanced"}),m.jsx("option",{value:"low",children:"Low Priority"})]})]})})]})]})]}),m.jsxs(x,{className:"mb-3",children:[m.jsx(x.Header,{children:m.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[m.jsx("h6",{className:"mb-0",children:"Schedule Settings"}),m.jsx(g.Check,{type:"switch",label:"Enable Schedule",checked:null==(h=O.schedule)?void 0:h.enabled,onChange:e=>I(c(r({},O),{schedule:c(r({},O.schedule),{enabled:e.target.checked})}))})]})}),(null==(u=O.schedule)?void 0:u.enabled)&&m.jsxs(x.Body,{children:[m.jsxs(b,{className:"mb-3",children:[m.jsx(p,{md:6,children:m.jsxs(g.Group,{children:[m.jsx(g.Label,{children:"Start Time"}),m.jsx(g.Control,{type:"time",value:(null==(y=O.schedule)?void 0:y.start_time)||"09:00",onChange:e=>I(c(r({},O),{schedule:c(r({},O.schedule),{start_time:e.target.value})}))})]})}),m.jsx(p,{md:6,children:m.jsxs(g.Group,{children:[m.jsx(g.Label,{children:"End Time"}),m.jsx(g.Control,{type:"time",value:(null==(f=O.schedule)?void 0:f.end_time)||"17:00",onChange:e=>I(c(r({},O),{schedule:c(r({},O.schedule),{end_time:e.target.value})}))})]})})]}),m.jsxs(g.Group,{children:[m.jsx(g.Label,{children:"Active Days"}),m.jsx("div",{className:"d-flex flex-wrap gap-2 mt-2",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(e=>{var s,n;return m.jsx(g.Check,{type:"checkbox",label:e.substring(0,3),checked:(null==(n=null==(s=O.schedule)?void 0:s.days)?void 0:n.includes(e))||!1,onChange:()=>(e=>{const s=O.schedule.days.includes(e)?O.schedule.days.filter(s=>s!==e):[...O.schedule.days,e];I(c(r({},O),{schedule:c(r({},O.schedule),{days:s})}))})(e),className:"me-2"},e)})})]})]})]}),m.jsxs(x,{children:[m.jsx(x.Header,{children:m.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[m.jsx("h6",{className:"mb-0",children:"Automation Triggers"}),m.jsxs(v,{variant:"outline-primary",size:"sm",onClick:()=>{const e=[...O.triggers,{id:`trigger_${Date.now()}`,type:"device_state",condition:"",action:"start_cleaning"}];I(c(r({},O),{triggers:e}))},children:[m.jsx(Z,{className:"me-1"}),"Add Trigger"]})]})}),m.jsx(x.Body,{children:0===(null==(_=O.triggers)?void 0:_.length)?m.jsx("p",{className:"text-muted text-center",children:"No triggers configured"}):m.jsx(k,{variant:"flush",children:null==(T=O.triggers)?void 0:T.map((e,s)=>m.jsxs(k.Item,{className:"d-flex justify-content-between align-items-center px-0",children:[m.jsxs("div",{children:[m.jsx(N,{bg:"secondary",className:"me-2",children:e.type}),e.condition," → ",e.action]}),m.jsx(v,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{const s=O.triggers.filter(s=>s.id!==e);I(c(r({},O),{triggers:s}))})(e.id),children:m.jsx(Y,{})})]},e.id))})})]})]})}),m.jsxs(C.Footer,{children:[m.jsx(v,{variant:"secondary",onClick:G,children:"Cancel"}),m.jsx(v,{variant:"primary",onClick:()=>{if(null!==z){const e=[...B];e[z]=c(r({},O),{id:B[z].id}),s(e)}else{const e=c(r({},O),{id:`zone_${Date.now()}`,created_at:(new Date).toISOString(),status:"active"});s([...B,e])}G()},disabled:!O.name.trim(),children:null!==z?"Update Zone":"Create Zone"})]})]})]})},le=({securityStatus:e})=>{const[s,n]=o.useState(null),[i,a]=o.useState(null),[t,l]=o.useState({}),[g,y]=o.useState({}),[f,_]=o.useState(!0),[C,k]=o.useState(!1),[w,S]=o.useState(!1),[G,F]=o.useState(!1),[E,P]=o.useState("mqtt"),[H,M]=o.useState(!1),[D,Z]=o.useState(""),[Q,J]=o.useState("success"),[V,U]=o.useState(!1);o.useEffect(()=>{$(),W(),Y()},[]),o.useEffect(()=>{if(s&&i){const e=JSON.stringify(s)!==JSON.stringify(i);U(e)}},[s,i]);const $=()=>d(void 0,null,function*(){try{_(!0);const e=yield h.get("/api/config");n(e),a(JSON.parse(JSON.stringify(e)))}catch(e){ce("Failed to load configuration","danger")}finally{_(!1)}}),W=()=>d(void 0,null,function*(){try{const s="low"!==(null==e?void 0:e.security_level);F(s),s||ce("Configuration editing restricted due to security level","warning")}catch(s){F(!1)}}),Y=()=>{const e=setInterval(()=>{V||ne()},3e4);return()=>clearInterval(e)},ne=()=>d(void 0,null,function*(){try{const e=yield h.get("/api/config"),s=JSON.stringify(e);s!==JSON.stringify(i)&&(ce("Configuration updated externally","info"),a(e),V||n(e))}catch(e){}}),le=o.useCallback(se.debounce(e=>d(void 0,null,function*(){var s;if(G&&e)try{S(!0);const n=yield h.post("/api/config/validate",e);l(n.errors||{}),y(n.warnings||{}),"high"===(null==(s=n.security_impact)?void 0:s.level)&&ce("Configuration changes have high security impact","warning")}catch(n){l({general:"Validation service unavailable"})}finally{S(!1)}}),750),[G]),re=(e,i)=>{const a=c(r({},s),{[e]:i});n(a),le(a)},ce=(e,s="success")=>{Z(e),J(s),M(!0)},de=e=>{switch(e){case"mqtt":return m.jsx(q,{className:"me-2"});case"security":return m.jsx(O,{className:"me-2"});case"zones":return m.jsx(R,{className:"me-2"});default:return m.jsx(K,{className:"me-2"})}},oe=(e,s)=>{const n=(e=>{const s=Object.keys(t).filter(s=>s.startsWith(e)),n=Object.keys(g).filter(s=>s.startsWith(e));return s.length>0?"error":n.length>0?"warning":"valid"})(e);return m.jsxs("span",{children:[de(e),s,"error"===n&&m.jsx(N,{bg:"danger",className:"ms-2",children:"!"}),"warning"===n&&m.jsx(N,{bg:"warning",className:"ms-2",children:"⚠"})]})};return f?m.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"400px"},children:m.jsxs("div",{className:"text-center",children:[m.jsx(u,{animation:"border",role:"status",className:"mb-3"}),m.jsx("div",{children:"Loading configuration..."})]})}):s?m.jsxs("div",{className:"unified-configuration-panel",children:[m.jsx(b,{className:"mb-4",children:m.jsx(p,{children:m.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[m.jsxs("div",{children:[m.jsxs("h4",{children:[m.jsx(K,{className:"me-2"}),"Unified Configuration"]}),m.jsx("p",{className:"text-muted mb-0",children:"Configure all AICleaner v3 settings from a single interface"})]}),m.jsxs("div",{className:"d-flex gap-2",children:[w&&m.jsxs(v,{variant:"outline-secondary",disabled:!0,children:[m.jsx(u,{size:"sm",className:"me-2"}),"Validating..."]}),V&&m.jsxs(v,{variant:"outline-warning",onClick:()=>{n(JSON.parse(JSON.stringify(i))),l({}),y({}),U(!1),ce("Configuration reset to last saved state","info")},disabled:!G,children:[m.jsx(X,{className:"me-2"}),"Reset"]}),m.jsx(v,{variant:"primary",onClick:()=>d(void 0,null,function*(){if(G&&!(Object.keys(t).length>0))try{k(!0);const e=yield h.post("/api/config",s);if("success"!==e.status)throw new Error(e.message||"Failed to save configuration");a(JSON.parse(JSON.stringify(s))),U(!1),ce("Configuration saved successfully","success")}catch(e){ce("Failed to save configuration: "+e.message,"danger")}finally{k(!1)}}),disabled:!G||C||!V||Object.keys(t).length>0,children:C?m.jsxs(m.Fragment,{children:[m.jsx(u,{size:"sm",className:"me-2"}),"Saving..."]}):m.jsxs(m.Fragment,{children:[m.jsx(ee,{className:"me-2"}),"Save Configuration"]})})]})]})})}),!G&&m.jsxs(j,{variant:"warning",className:"mb-4",children:[m.jsx(O,{className:"me-2"}),"Configuration editing is restricted due to current security level. Please resolve security issues in the Security Dashboard before making changes."]}),Object.keys(t).length>0&&m.jsxs(j,{variant:"danger",className:"mb-4",children:[m.jsx(B,{className:"me-2"}),m.jsx("strong",{children:"Configuration Errors:"}),m.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(t).map(([e,s])=>m.jsx("li",{children:s},e))})]}),m.jsx(x,{children:m.jsx(x.Body,{children:m.jsxs(T,{activeKey:E,onSelect:P,className:"mb-4",children:[m.jsx(L,{eventKey:"mqtt",title:oe("mqtt","MQTT Discovery"),children:m.jsx(ie,{config:s.mqtt||{},onChange:e=>re("mqtt",e),errors:t,warnings:g,canEdit:G,securityStatus:e})}),m.jsx(L,{eventKey:"security",title:oe("security","Security"),children:m.jsx(ae,{config:s.security||{},onChange:e=>re("security",e),errors:t,warnings:g,canEdit:G,securityStatus:e})}),m.jsx(L,{eventKey:"zones",title:oe("zones","Zones"),children:m.jsx(te,{config:s.zones||[],onChange:e=>re("zones",e),errors:t,warnings:g,canEdit:G,securityStatus:e})})]})})}),V&&m.jsxs(j,{variant:"info",className:"mt-3",children:[m.jsx(B,{className:"me-2"}),"You have unsaved changes. Don't forget to save your configuration."]}),m.jsx(A,{position:"top-end",className:"p-3",children:m.jsxs(z,{show:H,onClose:()=>M(!1),delay:5e3,autohide:!0,bg:Q,children:[m.jsxs(z.Header,{children:[m.jsx(I,{className:"me-2"}),m.jsx("strong",{className:"me-auto",children:"Configuration"})]}),m.jsx(z.Body,{className:"text-white",children:D})]})})]}):m.jsxs(j,{variant:"danger",children:[m.jsx(B,{className:"me-2"}),"Failed to load configuration. Please refresh the page.",m.jsx(v,{variant:"outline-danger",size:"sm",className:"ms-2",onClick:$,children:"Retry"})]})},re=Object.freeze(Object.defineProperty({__proto__:null,UnifiedConfigurationPanel:le,default:le},Symbol.toStringTag,{value:"Module"}));export{ne as C,re as U};
