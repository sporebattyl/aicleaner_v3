var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(t,n,s)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s,i=(e,t)=>{for(var n in t||(t={}))l.call(t,n)&&r(e,n,t[n]);if(s)for(var n of s(t))a.call(t,n)&&r(e,n,t[n]);return e},c=(e,s)=>t(e,n(s)),d=(e,t,n)=>new Promise((s,l)=>{var a=e=>{try{i(n.next(e))}catch(t){l(t)}},r=e=>{try{i(n.throw(e))}catch(t){l(t)}},i=e=>e.done?s(e.value):Promise.resolve(e.value).then(a,r);i((n=n.apply(e,t)).next())});import{r as o,j as h}from"./vendor-react-028964e9.js";import{A as u}from"./app-services-39021a89.js";import{a as m,b as j,A as v,R as x,C as p,B as y,M as b,F as g}from"./vendor-ui-95f0caeb.js";import"./vendor-export-9f6dbaf1.js";import"./vendor-utils-818bbafa.js";import"./app-analytics-3785476f.js";import"./vendor-charts-07629b84.js";import"./vendor-date-16f33ebf.js";import"./vendor-misc-6615fe3f.js";const f=()=>{var e,t;const[n,s]=o.useState([]),[l,a]=o.useState(!0),[r,f]=o.useState(null),[C,w]=o.useState(!1),[N,Z]=o.useState(null),[z,k]=o.useState({name:"",description:"",devices:[],schedule:{enabled:!1,start_time:"09:00",end_time:"17:00",days:[]}});o.useEffect(()=>{S()},[]);const S=()=>d(void 0,null,function*(){try{const e=yield u.getZones();s(e)}catch(e){f("Failed to load zones")}finally{a(!1)}}),_=(e=null)=>{Z(e),k(e||{name:"",description:"",devices:[],schedule:{enabled:!1,start_time:"09:00",end_time:"17:00",days:[]}}),w(!0)};return h.jsxs("div",{children:[h.jsxs(m,{children:[h.jsxs(m.Header,{className:"d-flex justify-content-between align-items-center",children:[h.jsx("h4",{children:"Zone Management"}),h.jsx(j,{variant:"primary",onClick:()=>_(),children:"Create Zone"})]}),h.jsxs(m.Body,{children:[r&&h.jsx(v,{variant:"danger",children:r}),h.jsx(x,{children:n.map(e=>{var t,n;return h.jsx(p,{md:6,lg:4,className:"mb-3",children:h.jsx(m,{children:h.jsxs(m.Body,{children:[h.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[h.jsx("h6",{children:e.name}),h.jsx(y,{bg:e.active?"success":"secondary",children:e.active?"Active":"Inactive"})]}),h.jsx("p",{className:"text-muted small",children:e.description}),h.jsxs("p",{className:"small",children:[h.jsx("strong",{children:"Devices:"})," ",(null==(t=e.devices)?void 0:t.length)||0]}),(null==(n=e.schedule)?void 0:n.enabled)&&h.jsxs("p",{className:"small",children:[h.jsx("strong",{children:"Schedule:"})," ",e.schedule.start_time," - ",e.schedule.end_time]}),h.jsxs("div",{className:"d-flex gap-1",children:[h.jsx(j,{variant:e.active?"outline-danger":"outline-success",size:"sm",onClick:()=>{return t=e.id,n=!e.active,d(void 0,null,function*(){try{yield u.toggleZone(t,n),yield S()}catch(e){f("Failed to toggle zone")}});var t,n},children:e.active?"Deactivate":"Activate"}),h.jsx(j,{variant:"outline-primary",size:"sm",onClick:()=>_(e),children:"Edit"}),h.jsx(j,{variant:"outline-danger",size:"sm",onClick:()=>{return t=e.id,d(void 0,null,function*(){if(window.confirm("Are you sure you want to delete this zone?"))try{yield u.deleteZone(t),yield S()}catch(e){f("Failed to delete zone")}});var t},children:"Delete"})]})]})})},e.id)})})]})]}),h.jsxs(b,{show:C,onHide:()=>w(!1),size:"lg",children:[h.jsx(b.Header,{closeButton:!0,children:h.jsx(b.Title,{children:N?"Edit Zone":"Create Zone"})}),h.jsx(b.Body,{children:h.jsxs(g,{children:[h.jsxs(g.Group,{className:"mb-3",children:[h.jsx(g.Label,{children:"Zone Name"}),h.jsx(g.Control,{type:"text",value:z.name,onChange:e=>k(c(i({},z),{name:e.target.value})),placeholder:"Enter zone name"})]}),h.jsxs(g.Group,{className:"mb-3",children:[h.jsx(g.Label,{children:"Description"}),h.jsx(g.Control,{as:"textarea",value:z.description,onChange:e=>k(c(i({},z),{description:e.target.value})),placeholder:"Enter zone description"})]}),h.jsx(g.Group,{className:"mb-3",children:h.jsx(g.Check,{type:"checkbox",label:"Enable Schedule",checked:(null==(e=z.schedule)?void 0:e.enabled)||!1,onChange:e=>k(c(i({},z),{schedule:c(i({},z.schedule),{enabled:e.target.checked})}))})}),(null==(t=z.schedule)?void 0:t.enabled)&&h.jsxs(x,{className:"mb-3",children:[h.jsxs(p,{md:6,children:[h.jsx(g.Label,{children:"Start Time"}),h.jsx(g.Control,{type:"time",value:z.schedule.start_time,onChange:e=>k(c(i({},z),{schedule:c(i({},z.schedule),{start_time:e.target.value})}))})]}),h.jsxs(p,{md:6,children:[h.jsx(g.Label,{children:"End Time"}),h.jsx(g.Control,{type:"time",value:z.schedule.end_time,onChange:e=>k(c(i({},z),{schedule:c(i({},z.schedule),{end_time:e.target.value})}))})]})]})]})}),h.jsxs(b.Footer,{children:[h.jsx(j,{variant:"secondary",onClick:()=>w(!1),children:"Cancel"}),h.jsx(j,{variant:"primary",onClick:()=>d(void 0,null,function*(){try{N?yield u.updateZone(N.id,z):yield u.createZone(z),w(!1),yield S()}catch(e){f("Failed to save zone")}}),children:N?"Update Zone":"Create Zone"})]})]})]})};export{f as ZoneManager};
